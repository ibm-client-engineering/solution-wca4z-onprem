"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9544],{326:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var s=t(5893),i=t(1151);const r={title:"Linux VM Setup",description:"Software Setup and Configuration for Refactor",sidebar_position:2,custom_edit_url:null},o="Linux VM Setup",a={id:"Create/linux_setup",title:"Linux VM Setup",description:"Software Setup and Configuration for Refactor",source:"@site/docs/02-Create/linux_setup.mdx",sourceDirName:"02-Create",slug:"/Create/linux_setup",permalink:"/solution-wca4z-onprem/Create/linux_setup",draft:!1,unlisted:!1,editUrl:null,tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Linux VM Setup",description:"Software Setup and Configuration for Refactor",sidebar_position:2,custom_edit_url:null},sidebar:"tutorialSidebar",previous:{title:"Windows VM Setup",permalink:"/solution-wca4z-onprem/Create/windows_setup"},next:{title:"Db2 & Data Gen Setup",permalink:"/solution-wca4z-onprem/Create/db2_datagen_setup"}},l={},c=[{value:"Installing and setting up on premise infrastructure",id:"installing-and-setting-up-on-premise-infrastructure",level:2},{value:"Installing ADDI",id:"installing-addi",level:2},{value:"Installing the Refactoring Assistant:",id:"installing-the-refactoring-assistant",level:2},{value:"Configuring Refactoring Assistant",id:"configuring-refactoring-assistant",level:3},{value:"Additional RA settings using HTTPS",id:"additional-ra-settings-using-https",level:3},{value:"Configure ADDI(DEX)",id:"configure-addidex",level:3},{value:"Prepare Security Certificates for ADDI and RA",id:"prepare-security-certificates-for-addi-and-ra",level:3},{value:"For all three certificates:",id:"for-all-three-certificates",level:4},{value:"Finishing the configuration of Refactoring Assistant to use HTTPS",id:"finishing-the-configuration-of-refactoring-assistant-to-use-https",level:3},{value:"Enabling security in the ADDI Dashboard",id:"enabling-security-in-the-addi-dashboard",level:2},{value:"Configuring AD Analyze for TLS",id:"configuring-ad-analyze-for-tls",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"linux-vm-setup",children:"Linux VM Setup"}),"\n",(0,s.jsx)(n.h2,{id:"installing-and-setting-up-on-premise-infrastructure",children:"Installing and setting up on premise infrastructure"}),"\n",(0,s.jsx)(n.p,{children:"The recommended order for installing and setting up the solution is:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Install ADDI in a Windows VM (following the ADDI cookbook this will get you to the\npoint of setting up the server, front end, and creating a project)."}),"\n",(0,s.jsx)(n.li,{children:"Install Refactoring Assistant in a Linux VM."}),"\n",(0,s.jsx)(n.li,{children:"Configure the two products to connect securely."}),"\n",(0,s.jsx)(n.li,{children:"Provision an IBM watsonx Code Assistant service in IBM Cloud, including creating the\nDb2 database."}),"\n",(0,s.jsx)(n.li,{children:"Create an API key to access the watsonx Code Assistant service."}),"\n",(0,s.jsx)(n.li,{children:"Configure ADDI to use the Cloud Db2 database."}),"\n",(0,s.jsx)(n.li,{children:"Set up the Data Generator for transformation."}),"\n",(0,s.jsx)(n.li,{children:"Install Visual Studio Code and add the Z Open Editor extension and Language Support\nfor Java extension."}),"\n",(0,s.jsx)(n.li,{children:"Run through the end to end scenario."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"installing-addi",children:"Installing ADDI"}),"\n",(0,s.jsx)(n.p,{children:"As mentioned earlier, the process for Installing ADDI is explained in the ADDI cookbook. After you have installed and set up ADDI, you are ready to install and configure the Refactoring Assistant."}),"\n",(0,s.jsx)(n.h2,{id:"installing-the-refactoring-assistant",children:"Installing the Refactoring Assistant:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Log in in your RHEL 8.x env via SSH e.g:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ssh root@<your-test-host-name>\n"})}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"By default, you are in the /root directory. Download the latest Refactoring Assistant (either directly on the RHEL VM or move it there afterwards)."}),"\n",(0,s.jsxs)(n.li,{children:["Extract the tar file:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"tar -xzvf <refactoring-assistant_file_version>.tgz\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Move the refactoring assistant outside to the root folder","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mv <path_to_refactoring_assistant> /root/refactoring-assistant\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["You should now have a new directory /root/refactoring-assistant. Navigate to that directory there:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd /root/refactoring-assistant\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Run the setup file","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"./setup.sh\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"You may need to expose port 9443 for the Refactoring Assistant Web UI"})})}),"\n",(0,s.jsx)(n.h3,{id:"configuring-refactoring-assistant",children:"Configuring Refactoring Assistant"}),"\n",(0,s.jsx)(n.admonition,{title:"WAIT!",type:"danger",children:(0,s.jsx)(n.p,{children:"You need an ADDI environment ID before continuing with the RA configuration."})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["In your RHEL 8.x env go to:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd /root/refactoring-assistant\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Create a configuration from the template by copying and then editng it:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cp config/template.properties config/config.properties\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Then update config/config.properties as follow:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:"title='config.properties'  ",children:"CERTS_LOCATION=/root/certificate\nPROTOCOL=https\nAD_HOST_PORT=<FQDN Address of your Windows VM>:2181\nENVIRONMENT_ID=<Your ADDI Environment ID>\nDEX_HOST_PORT=\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Important details on these fields."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"CERTS_LOCATION"})," - Absolute path to directory where certificates and keys are kept. These items will need to be created"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"PROTOCOL"})," - Protocol to use to communicate with AD services"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"AD_HOST_PORT"})," - The IBM AD configuration (ZooKeeper) connection string, e.g. <hostname.mydomain.com>:2281 ( use port 2181 if connection is unsecured )"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"ENVIRONMENT_ID"})," - The environment ID, which can be obtained from the IBM Application Discovery Configuration Service Admin dashboard, more details on this webpage\n",(0,s.jsx)(n.a,{href:"https://www.ibm.com/docs/en/addi/latest?topic=configuring-by-using-ad-configuration-service",children:"https://www.ibm.com/docs/en/addi/latest?topic=configuring-by-using-ad-configuration-service"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DEX_HOST_PORT"})," - The location of the DEX authentication server, defaults to $PROTOCOL://$AD_HOST:7600 if unset"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Additional properties you can add to this file are listed below:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Ports of the AD mainframe projects and file services respectively","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"AD_PROJ_PORT=7650\nAD_FILE_PORT=7700\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Outbound mail settings to enable email notifications","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"MAIL_HOST=\nMAIL_PORT=\nMAIL_USERNAME=\nMAIL_PASSWORD=\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Extra Java mail properties, which can be specified by using MAIL_PROPERTIES_ prefix followed by the property name with dot separators replaced by underscores","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"MAIL_PROPERTIES_MAIL_SMTP_AUTH=true\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["If your system has Security-Enhanced Linux (SELinux) feature enabled, you need to add the following additional property","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"RA_MOUNT_OPTIONS=:Z\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Make sure you save and confirm your changes."})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat config/config.properties\n"})}),"\n",(0,s.jsx)(n.h3,{id:"additional-ra-settings-using-https",children:"Additional RA settings using HTTPS"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"In your RHEL 8.x test env go to: cd /root/refactoring-assistant"}),"\n",(0,s.jsx)(n.li,{children:"To prepare the required certificates, run ./start.sh --prepare-only /root/certificate"}),"\n",(0,s.jsxs)(n.li,{children:["From /root/certificate, copy the root.crt certificate to your Windows VM","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["In your Windows env, use PowerShell and use a command like this :","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"scp root@<your-host-Lin>:/root/certificate/root.crt C:\\Users\\Administrator\\Downloads\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Continue with the ADDI setup on section Prepare Security Certificates for ADDI and RA, step #8 - Once completed that section, resume here(you should have the zookeeper certificate by then)"}),"\n",(0,s.jsx)(n.li,{children:"Take the zookeeper.crt certificate, copy it two times and name the copies \u201cad.crt\u201d and \u201cdex.crt\u201d"}),"\n",(0,s.jsxs)(n.li,{children:["Edit the config.properties configuration file to match these conditions:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"PROTOCOL=https\nChange the port number of AD_HOST_PORT to 2281\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Restart RA","\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"< stop.sh all > will stop all the services including the database store, deleting all the files in your project. Use < ./stop.sh > without the all flag to stop only the RA service"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"./stop.sh all\n./start.sh\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"configure-addidex",children:"Configure ADDI(DEX)"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["In your ADDI Windows env, go to ",(0,s.jsx)(n.a,{href:"https://localhost:9443/ad/admin/configure?tab=environments",children:"https://localhost:9443/ad/admin/configure?tab=environments"})," and locate the ADDI Environment ID"]}),"\n",(0,s.jsx)(n.li,{children:"Go to C:\\Program Files\\IBM Application Discovery and Delivery Intelligence\\Authentication Server (DEX)\\conf\\ and edit the dex.yaml file"}),"\n",(0,s.jsxs)(n.li,{children:["Edit the issuer value to be: ",(0,s.jsx)(n.code,{children:"https://localhost:7600/dex"})]}),"\n",(0,s.jsxs)(n.li,{children:["Add the following to the list of static clients:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"staticClients:\n-\nid: refactoring-assistant\nredirectURIs:\n- https://<your RA Linux hostname>:9443\nname: Refactoring Assistant\nsecret: pkce\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"There are further settings for Authentication Server (DEX) in the \u201cEnable Security in ADDI Dashboard\u201d section, for now don\u2019t worry about the status of DEX."}),"\n",(0,s.jsx)(n.h3,{id:"prepare-security-certificates-for-addi-and-ra",children:"Prepare Security Certificates for ADDI and RA"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Download and install prerequisites","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Download the SSL certificate (DigiCertGlobalRootCA) to your Windows VM"}),"\n",(0,s.jsxs)(n.li,{children:["You can find the link to download the SSL certificate in the email sent you with your access details in the DB2 section.","\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["For an integration test team, look in your ",(0,s.jsx)(n.code,{children:"\\Downloads"})," for something like ",(0,s.jsx)(n.code,{children:"DigiCertGlobalRootCA_wca4z-int-test-db2-<-suffix>.crt"})]})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Generate a public and private key pair using the Java keytool utility:","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Open a command prompt terminal and navigate to the Downloads directory"}),"\n",(0,s.jsxs)(n.li,{children:["Replace the FQDN of your Windows VM in the command below and execute it.","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'keytool \n-genkeypair \n-alias "<FQDN of your Windows VM>"\n-keyalg RSA -keysize 2048 \n-dname "cn=< FQDN of your Windows VM>" \n-keypass password \n-keystore server_keystore.p12 \n-storepass password \n-storetype PKCS12 \n-ext BasicConstraints:critical=ca:true \n-ext san=dns:<FQDN of your Windows VM>\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["By default, such certificates are valid for only 90 days. Passing an additional argument ",(0,s.jsx)(n.code,{children:"-validity 366"})," will extend the validity of the self-signed certificate to a year (in general: to the given number of days)"]})}),"\n"]}),"\n"]}),"\n","A keystore file should be generated. ",(0,s.jsx)(n.strong,{children:"Example location:"})," ",(0,s.jsx)(n.code,{children:"C:\\Users\\Administrator\\Downloads\\server_keystore.p12"})]}),"\n",(0,s.jsxs)(n.li,{children:["Export the certificate:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'keytool \n-exportcert \n-alias "<FQDN of your Windows VM>" \n-keystore "server_keystore.p12"\n-file "server_certificate.crt" \n-storepass "password"\n'})}),"\n","You should get certificate stored in file ",(0,s.jsx)(n.code,{children:"<server_certificate.crt>"})," in the directory you're working on."]}),"\n",(0,s.jsxs)(n.li,{children:["Re-import the certificate into the keystore:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'keytool -keystore server_keystore.p12 -import -file "server_certificate.crt" -alias "self-signed-root"\nEnter keystore password: <\u201dpassword\u201d is your password>\nCertificate already exists in keystore under alias <FQDN of VM>\nDo you still want to add it? [no]: yes\n'})}),"\n","You should recieve a prompt stating: ",(0,s.jsx)(n.code,{children:'"Certificate was added to keystore"'})]}),"\n",(0,s.jsxs)(n.li,{children:["Use the openSSL command prompt to generate the server.key file:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"openssl pkcs12 -in server_keystore.p12 -nocerts -nodes -out server.key\nEnter Import Password: password\n"})}),"\n","A server key file should be generated. ",(0,s.jsx)(n.strong,{children:"Example location:"})," ",(0,s.jsx)(n.code,{children:"C:\\Users\\Administrator\\Downloads\\server.key"})]}),"\n",(0,s.jsxs)(n.li,{children:["To generate the server_certificate.crt file run the following command:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"keytool -list -keystore server_keystore.p12 -rfc > server_certificate.crt\nEnter Keystore Password: password\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Import the Db2 SSL certificate into the keystore:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'keytool -import -trustcacerts -alias "DB2-ssl-cert" -file <path to the DigiCertGlobalRootCA downloaded from Db2> -keystore server_keystore.p12 -storepass password\nCertificate already exists in system-wide CA keystore under alias <digicertglobalrootca [jdk]>\nDo you still want to add it to your own keystore? [no]: yes\nCertificate was added to keystore\n'})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Import the root.crt into the keystore - You can download root.crt from your RA Linux machine to your Windows env with the command:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'scp root@<your-host-Win>:/root/certificate/root.crt C:\\Users\\Administrator\\Downloads\n\nkeytool -importcert -alias ad-core-server -keystore "server_keystore.p12" -file root.crt -storepass password -ext BasicConstraints:critical=ca:true -ext san=dns:<FQDN of your Windows VM>\nTrust this certificate? [no]: yes\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Install the DigiCertGlobalRootCA, the ",(0,s.jsx)(n.code,{children:"server_certificate.crt"})," and the ",(0,s.jsx)(n.code,{children:"root.crt"})," (from the RA setup) into the Windows VM\u2019s trusted root certificate authorities."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"for-all-three-certificates",children:"For all three certificates:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Right-click the certificate and select ",(0,s.jsx)(n.code,{children:"Install certificate"})]}),"\n",(0,s.jsxs)(n.li,{children:["If ",(0,s.jsx)(n.code,{children:"Security Warning"})," is displayed, select ",(0,s.jsx)(n.code,{children:"Open"}),", otherwise continue with the next step"]}),"\n",(0,s.jsxs)(n.li,{children:["Select ",(0,s.jsx)(n.code,{children:"Local Machine"}),", select ",(0,s.jsx)(n.code,{children:"Next"})]}),"\n",(0,s.jsxs)(n.li,{children:["Select  ",(0,s.jsx)(n.code,{children:"Place all certificates in the following store"})]}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.code,{children:"Browse\u2026"})]}),"\n",(0,s.jsxs)(n.li,{children:["Select ",(0,s.jsx)(n.code,{children:"Trusted Root certificate authorities"})]}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.code,{children:"OK"}),", then ",(0,s.jsx)(n.code,{children:"Next"})]}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.code,{children:"Finish"})," ( you\u2019ll see pop up alert stating \u201cThe import was successful.\u201d )","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["The pop-up message takes some time. to be displayed. Select ",(0,s.jsx)(n.code,{children:"OK"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Install the ",(0,s.jsx)(n.code,{children:"DigiCertGlobalRootCA"}),", the ",(0,s.jsx)(n.code,{children:"server_certificate.crt"})," and the ",(0,s.jsx)(n.code,{children:"root.crt"})," into Java\u2019s cacerts keystore:","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Open a command prompt in the directory containing the new ",(0,s.jsx)(n.code,{children:"server_keystore.p12"})]}),"\n",(0,s.jsxs)(n.li,{children:["Enter the following command to import all certificates from the server_keystore into the cacerts keystore:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'    keytool -importkeystore -srckeystore "server_keystore.p12" -srcstorepass "password" -destkeystore "%JAVA_HOME%\\lib\\security\\cacerts" -deststorepass "changeit"\n\n    Importing keystore server_keystore.p12 to C:\\Program\n    Files\\OpenLogic\\jre-11.0.20.8-hotspot\\lib\\security\\cacerts...\n    Entry for alias <\u2026hostname\u2026> successfully imported.\n    Entry for alias self-signed-root successfully imported.\n    Entry for alias db2-ssl-cert successfully imported.\n    Entry for alias ad-core-server successfully imported.\n    Import command completed: 4 entries successfully imported, 0\n    entries failed or cancelled\n'})}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"cacerts location could be different depending on your Java installation. In Openlogic Java 11 the cacerts are found in"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"%JAVA_HOME%\\lib\\security\\cacerts v/s\n%JAVA_HOME%\\jre\\lib\\security\\cacerts\n"})})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["From the ADDI dashboard ( ",(0,s.jsx)(n.code,{children:"https://localhost:9443/ad/admin/dashboard"})," ), restart the \u201cConfiguration service\u201d"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Get the ",(0,s.jsx)(n.code,{children:"zookeeper.crt"})," certificate","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'keytool -exportcert -alias "<FQDN of your Windows VM>" -keystore "server_keystore.p12" -rfc -file zookeeper.crt -storepass password -ext BasicConstraints:critical=ca:true -ext san=dns:<FQDN of your Windows VM>\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Copy the ",(0,s.jsx)(n.code,{children:"zookeeper.crt"})," file to ",(0,s.jsx)(n.code,{children:"/root/certificate"})," on your RHEL VM.","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["From your Windows env, you can upload ",(0,s.jsx)(n.code,{children:"zookeeper.crt"})," with the following command on PowerShell terminal:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"scp C:\\Users\\Administrator\\Downloads\\zookeeper.crt root@<Your-Linux-FQDN>:/root/certificate/\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"At this point you\u2019re ready to finish setting up the HTTPS connection and certificates for the Refactoring Assistant."}),"\n",(0,s.jsx)(n.h3,{id:"finishing-the-configuration-of-refactoring-assistant-to-use-https",children:"Finishing the configuration of Refactoring Assistant to use HTTPS"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Take the ",(0,s.jsx)(n.code,{children:"zookeeper.crt"})," certificate, copy it two times and name the copies ",(0,s.jsx)(n.code,{children:"ad.crt"})," and ",(0,s.jsx)(n.code,{children:"dex.crt"})]}),"\n",(0,s.jsxs)(n.li,{children:["Restart RA","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"./stop.sh all\n./start.sh\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["When asked for the OrientDB password, enter ",(0,s.jsx)(n.code,{children:"inittest"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"enabling-security-in-the-addi-dashboard",children:"Enabling security in the ADDI Dashboard"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["In the ADDI dashboard, go to ",(0,s.jsx)(n.code,{children:"Configure"})," -> ",(0,s.jsx)(n.code,{children:"<environment-name>"})," -> ",(0,s.jsx)(n.code,{children:"General"})," and check that the \u201cIP or host\u201d field has the FQDN of your Windows VM"]}),"\n",(0,s.jsxs)(n.li,{children:["Next, go to ",(0,s.jsx)(n.code,{children:"Servers and security"})," -> ",(0,s.jsx)(n.code,{children:"Security"})]}),"\n",(0,s.jsxs)(n.li,{children:["Select ",(0,s.jsx)(n.code,{children:"Protocol"})," type ",(0,s.jsx)(n.code,{children:"HTTPS"})]}),"\n",(0,s.jsxs)(n.li,{children:["Drag and drop the below files from your Windows File Explorer to your web browser under the Security and certificate files","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"server_keystore.p12\nserver.key\nserver_certificate.crt\n"})}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"After selecting the files, enter \u201cpassword\u201d for the keystore password"}),"\n",(0,s.jsxs)(n.li,{children:["Click ",(0,s.jsx)(n.code,{children:"Save"})," then ",(0,s.jsx)(n.code,{children:"OK"})," ( this step may take some time)"]}),"\n",(0,s.jsxs)(n.li,{children:["Your dex.yaml file should now looks like this:","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="dex.yaml"        ',children:"        schemaVersion: 0\n        issuer: https://localhost:7600/dex\n        storage:\n        type: sqlite3\n        config:\n        file: dex.db\n        frontend:\n        theme: addi\n        web:\n        https: 0.0.0.0:7600\n        TLSCert: C:\\Program Files\\IBM Application Discovery and Delivery\n        Intelligence\\security\\<\u2026hash-path-goes-here\u2026>\\server_certificate.crt\n        TLSKey: C:\\Program Files\\IBM Application Discovery and Delivery\n        Intelligence\\security\\<\u2026hash-path-goes-here\u2026>\\server.key\n        oauth2:\n        skipApprovalScreen: true\n        passwordConnector: ldap\n        connectors: []\n        staticClients:\n        -\n        id: refactoring-assistant\n        redirectURIs:\n        - https://<your RA Linux FQDN>:9443\n        name: Refactoring Assistant\n        secret: pkce\n        enablePasswordDB: true\n        staticPasswords:\n        -\n        email: tester@servicedesigner.com\n        hash: $2a$12$m2dGtrCtc320uPbjgIOydeYxjePRhPU3WZ34z4CF.iK7oiYcEwRwe\n        username: null\n        userID: null\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["If your DEX service does not start, have a look at ",(0,s.jsx)(n.code,{children:"C:\\Program Files\\IBM Application Discovery and Delivery Intelligence\\Authentication Server (DEX)\\dex.log"})]})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Restart services by navigating to the ADDI dashboard and selecting the three dots next to the service.","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["From the ADDI dashboard restart the following:","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Authentication Server (DEX)"}),"\n",(0,s.jsx)(n.li,{children:"File Service"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"From the start menu, find and open the Services system app"}),"\n",(0,s.jsxs)(n.li,{children:["Select ",(0,s.jsx)(n.code,{children:"IBM Application Discovery WebSphere Liberty Profile Service"})," and restart it (the ADDI dashboard might be unavailable even some time after the WebSphere Liberty Service is shown as Running again)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"configuring-ad-analyze-for-tls",children:"Configuring AD Analyze for TLS"}),"\n",(0,s.jsx)(n.p,{children:"By default, the IBM AD Analyze Client runs in unencrypted mode. The ADDI cookbook doesn\u2019t cover steps to use TLS support. So if you want to securely connect to the server from the IBM AD Analyze Client with TLS support, you need to perform the following steps:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Make sure HTTPS is configured from the Security Page in the IBM ADDI Dashboard."}),"\n",(0,s.jsx)(n.li,{children:"Close the Eclipse Analyze Client"}),"\n",(0,s.jsxs)(n.li,{children:["Go to the location where you unzipped the Eclipse package, for example ",(0,s.jsx)(n.code,{children:"C:\\eclipse"})]}),"\n",(0,s.jsxs)(n.li,{children:["Open ",(0,s.jsx)(n.code,{children:"eclipse.ini"})," file and add the following lines, in the ",(0,s.jsx)(n.code,{children:"-vmargs"})," section (if vmargs section is missing you can add new one). ",(0,s.jsxs)(n.strong,{children:["Avoid blank lines in the ",(0,s.jsx)(n.code,{children:"-vmargs"})," section."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",metastring:"title='eclipse.ini -vmargs'        ",children:"        -Dzookeeper.client.secure=true\n        -Dzookeeper.ssl.keyStore.location=<the location on disk where the keystore was stored>\n        -Dzookeeper.ssl.keyStore.password=<keystore password>\n        -Dzookeeper.ssl.trustStore.location=<the location on disk where the truststore was stored>\n        -Dzookeeper.ssl.trustStore.password=<truststore password>\n        -Dclient.ssl.enabled=true\n        -Djavax.net.ssl.keyStore=<the location on disk where the keystore was stored>\n        -Djavax.net.ssl.keyStorePassword=<keystore password>\n        -Djavax.net.ssl.trustStore=<the location on disk where the truststore was stored>\n        -Djavax.net.ssl.trustStorePassword=<truststore password>\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["The security keystore you add to Analyze Client needs to be configured with the Fully Qualified Domain Name of the Server VM in the Subject (CN) and Subject Alternative Name (SAN) fields. If IP address is used with the security certs then you might hit the following error message in Analyze Client:\n",(0,s.jsx)(n.code,{children:"Caused by: java.security.cert.CertificateException: No subject alternative names matching IP address 9.46.97.193 found"})]})}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Save and close the file"}),"\n",(0,s.jsx)(n.li,{children:"Restart Eclipse/Analyze Client"}),"\n",(0,s.jsxs)(n.li,{children:["In Eclipse go to ",(0,s.jsx)(n.code,{children:"Window"})," -> ",(0,s.jsx)(n.code,{children:"Preferences"})," -> ",(0,s.jsx)(n.code,{children:"Application Discovery"})," -> ",(0,s.jsx)(n.code,{children:"Environment"})," sections"]}),"\n",(0,s.jsxs)(n.li,{children:["Update below data with TLS information (You can get Environment ID and Name from the ADDI Dashboard in the Configure tab):","\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"Host: <FQDN of the Windows VM>\nPort: 2281\nUnique ID: <ADDI Environment ID>\nName: <ADDI Environment Name>\n"})}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Restart Eclipse/Analyze Client"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>o});var s=t(7294);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);